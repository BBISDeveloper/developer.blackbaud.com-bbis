/*
//===============================================================================================================
// System  : Sandcastle Help File Builder
// File    : branding.js
// Author  : Eric Woodruff  (Eric@EWoodruff.us)
// Updated : 05/15/2014
// Note    : Copyright 2014, Eric Woodruff, All rights reserved
//           Portions Copyright 2010-2014 Microsoft, All rights reserved
//
// This file contains the methods necessary to implement the language filtering, collapsible section, and
// copy to clipboard options.
//
// This code is published under the Microsoft Public License (Ms-PL).  A copy of the license should be
// distributed with the code.  It can also be found at the project website: http://SHFB.CodePlex.com.  This
// notice, the author's name, and all copyright notices must remain intact in all applications, documentation,
// and source files.
//
//    Date     Who  Comments
// ==============================================================================================================
// 05/04/2014  EFW  Created the code based on the MS Help Viewer script
//===============================================================================================================
*/

var allTabSetIds=[],allLSTSetIds={},isHelp1,curLoc=document.location+".";0==curLoc.indexOf("mk:@MSITStore")?(isHelp1=!0,curLoc="ms-its:"+curLoc.substring(14,curLoc.length-1),document.location.replace(curLoc)):isHelp1=0==curLoc.indexOf("ms-its:")?!0:!1;
function OnLoad(a){a="undefined"==typeof a||null==a||""==a?"vb":a;try{var b=document.getElementById("pageFooter");if(b){var c=document.body;b.parentElement!=c&&(b.parentElement.removeChild(b),c.appendChild(b))}}catch(d){}b=GetCookie("CodeSnippetContainerLanguage",a);UpdateLST(b);if(0<allTabSetIds.length)for(c=0;c<allTabSetIds.length;){for(a=1;null!=document.getElementById(allTabSetIds[c]+"_tab"+a);)a++;a--;2>a?-1!=navigator.userAgent.toLowerCase().indexOf("chrome")&&(document.getElementById(allTabSetIds[c]+
"_copyCode").style.display="none"):SetCurrentLanguage(allTabSetIds[c],b,a);c++}InitializeToc()}function InitializeToc(){}
function UpdateLST(a){for(var b in allLSTSetIds){var c=document.getElementById(b);if(null!=c){null!=c.previousSibling&&null!=c.previousSibling.nodeValue&&(c.previousSibling.nodeValue=c.previousSibling.nodeValue.replace(/\s+$/,""));for(var d=allLSTSetIds[b].split("|"),e=0,f;e<d.length;){f=d[e].split("=");if(f[0]==a){c.innerHTML=f[1];break}e++}if(e>=d.length){if("nu"!=a)for(e=0;e<d.length;){f=d[e].split("=");if("nu"==f[0]){c.innerHTML=f[1];break}e++}e>=d.length&&(c.innerHTML="")}}}}
function GetCookie(a,b){if(isHelp1)try{var c=Help1Globals.Load(a);null==c&&(c=b);return c}catch(d){return b}for(var c=document.cookie.split("; "),e=0;e<c.length;e++){var f=c[e].split("=");if(a==f[0])return unescape(f[1])}return b}function SetCookie(a,b){if(isHelp1)try{Help1Globals.Save(a,b)}catch(c){}else{var d=new Date;d.setTime(d.getTime());d=new Date(d.getTime()+5184E6);document.cookie=a+"="+escape(b)+";expires="+d.toGMTString()+";path=/"}}
function AddLanguageSpecificTextSet(a){a=a.split("?");allLSTSetIds[a[0]]=a[1]}function AddLanguageTabSet(a){allTabSetIds.push(a)}function ChangeTab(a,b,c,d){SetCookie("CodeSnippetContainerLanguage",b);SetActiveTab(a,c,d);UpdateLST(b);for(c=0;c<allTabSetIds.length;){if(allTabSetIds[c]!=a){for(d=1;null!=document.getElementById(allTabSetIds[c]+"_tab"+d);)d++;d--;1<d&&SetCurrentLanguage(allTabSetIds[c],b,d)}c++}}
function SetCurrentLanguage(a,b,c){for(var d=1;d<=c;){var e=document.getElementById(a+"_tab"+d);if(null!=e&&-1!=e.innerHTML.indexOf("'"+b+"'"))break;d++}if(d>c&&(d=1,"codeSnippetContainerTabPhantom"==document.getElementById(a+"_tab1").className))for(d++;d<=c;){b=document.getElementById(a+"_tab"+d);if("codeSnippetContainerTabPhantom"!=b.className){b.className="codeSnippetContainerTabActive";document.getElementById(a+"_code_Div"+j).style.display="block";break}d++}SetActiveTab(a,d,c)}
function SetActiveTab(a,b,c){for(var d=1;d<=c;){var e=document.getElementById(a+"_tab"+d);"codeSnippetContainerTabActive"==e.className?e.className="codeSnippetContainerTab":"codeSnippetContainerTabPhantom"==e.className&&(e.style.display="none");e=document.getElementById(a+"_code_Div"+d);"none"!=e.style.display&&(e.style.display="none");d++}"codeSnippetContainerTabPhantom"!=document.getElementById(a+"_tab"+b).className?document.getElementById(a+"_tab"+b).className="codeSnippetContainerTabActive":document.getElementById(a+
"_tab"+b).style.display="block";document.getElementById(a+"_code_Div"+b).style.display="block";-1==navigator.userAgent.toLowerCase().indexOf("chrome")?document.getElementById(a+"_copyCode").style.display="inline":document.getElementById(a+"_copyCode").style.display="none"}
function CopyToClipboard(a){var b,c,d=1;do{c=a+"_code_Div"+d;b=document.getElementById(c);if(null!=b&&"none"!=b.style.display)break;d++}while(null!=b);if(null!=b)if(window.clipboardData)try{window.clipboardData.setData("Text",document.getElementById(c).innerText)}catch(e){alert("Permission denied. Enable copying to the clipboard.")}else if(window.netscape)try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var f=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);
if(f){var g=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(g){g.addDataFlavor("text/unicode");a={};a=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var h=document.getElementById(c).textContent;a.data=h;g.setTransferData("text/unicode",a,2*h.length);f.setData(g,null,Components.interfaces.nsIClipboard.kGlobalClipboard)}}}catch(k){alert('Permission denied. Enter "about:config" in the address bar and double-click the "signed.applets.codebase_principal_support" setting to enable copying to the clipboard.')}}
function SectionExpandCollapse(a){var b=document.getElementById(a+"Toggle");a=document.getElementById(a+"Section");null!=b&&null!=a&&(""==a.style.display?(b.src=b.src.replace("SectionExpanded.png","SectionCollapsed.png"),a.style.display="none"):(b.src=b.src.replace("SectionCollapsed.png","SectionExpanded.png"),a.style.display=""))}function SectionExpandCollapse_CheckKey(a,b){13==b.keyCode&&SectionExpandCollapse(a)}
var Help1Globals={UserDataCache:function(){return document.getElementById("userDataCache")},Load:function(a){var b=this.UserDataCache();b.load("userDataSettings");return b.getAttribute(a)},Save:function(a,b){var c=this.UserDataCache();c.setAttribute(a,b);c.save("userDataSettings")}};